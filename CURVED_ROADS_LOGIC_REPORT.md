# üõ£Ô∏è Curved Roads Logic Report

## –ê–Ω–∞–ª–∏–∑ —Å—Ö–µ–º—ã "result"

–°–æ–≥–ª–∞—Å–Ω–æ –±–ª–æ–∫—É "result" –Ω–∞ —Å—Ö–µ–º–µ:

### –õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Ä–æ–≥:
- **üü¢ –ó–µ–ª–µ–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞** = **—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞** –¥–æ—Ä–æ–≥–∏ –≤ —è—á–µ–π–∫—É
- **üî¥ –ö—Ä–∞—Å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞** = **—Ç–æ—á–∫–∞ –≤—ã—Ö–æ–¥–∞** –¥–æ—Ä–æ–≥–∏ –∏–∑ —è—á–µ–π–∫–∏
- **üîÑ –ò–∑–≥–∏–±**: –î–æ—Ä–æ–≥–∞ –¥–æ–ª–∂–Ω–∞ –∏–∑–≥–∏–±–∞—Ç—å—Å—è –æ—Ç –∑–µ–ª–µ–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∫ –∫—Ä–∞—Å–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–µ —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä —è—á–µ–π–∫–∏

### –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ:
- **Object 1**: –î–æ—Ä–æ–≥–∞ –∏–¥–µ—Ç –æ—Ç –∑–µ–ª–µ–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã "A" (–≤–µ—Ä—Ö-–ª–µ–≤–æ), –∏–∑–≥–∏–±–∞–µ—Ç—Å—è –∫ —Ü–µ–Ω—Ç—Ä—É, –≤—ã—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∫—Ä–∞—Å–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É "C" (–Ω–∏–∑-–ø—Ä–∞–≤–æ)
- **Object 2**: –î–æ—Ä–æ–≥–∞ –∏–¥–µ—Ç –æ—Ç –∑–µ–ª–µ–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã "f" (–Ω–∏–∑-–ª–µ–≤–æ), –∏–∑–≥–∏–±–∞–µ—Ç—Å—è –∫ —Ü–µ–Ω—Ç—Ä—É, –≤—ã—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∫—Ä–∞—Å–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É "C" (–≤–µ—Ä—Ö-–ø—Ä–∞–≤–æ)
- **–§–æ—Ä–º–∞**: –î–æ—Ä–æ–≥–∞ –∏–º–µ–µ—Ç V-–æ–±—Ä–∞–∑–Ω—É—é —Ñ–æ—Ä–º—É —Å –∏–∑–≥–∏–±–æ–º –∫ —Ü–µ–Ω—Ç—Ä—É —è—á–µ–π–∫–∏

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞

### 1. –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç CurvedRoadSegment

```typescript
const CurvedRoadSegment: React.FC<{
  segment: {
    position: [number, number, number]
    rotation: [number, number, number]
    length: number
    width: number
    type: 'straight' | 'curved'
    entrySide: number
    exitSide: number
  }
  linkType: 'primary' | 'secondary'
}> = ({ segment, linkType }) => {
  // –õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–æ–≥–Ω—É—Ç—ã—Ö –¥–æ—Ä–æ–≥
}
```

### 2. –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ—á–µ–∫ –∏–∑–≥–∏–±–∞

```typescript
const getCurvedRoadPoints = () => {
  // –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–∑–µ–ª–µ–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞)
  const entryAngle = (entrySide * Math.PI) / 3
  const entryPoint = [
    Math.cos(entryAngle) * 0.8,
    0,
    Math.sin(entryAngle) * 0.8
  ]
  
  // –¢–æ—á–∫–∞ –≤—ã—Ö–æ–¥–∞ (–∫—Ä–∞—Å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞)
  const exitAngle = (exitSide * Math.PI) / 3
  const exitPoint = [
    Math.cos(exitAngle) * 0.8,
    0,
    Math.sin(exitAngle) * 0.8
  ]
  
  // –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –∏–∑–≥–∏–±–∞ (–±–ª–∏–∂–µ –∫ —Ü–µ–Ω—Ç—Ä—É)
  const controlPoint = [
    (entryPoint[0] + exitPoint[0]) * 0.3,
    0,
    (entryPoint[2] + exitPoint[2]) * 0.3
  ]
  
  return [entryPoint, controlPoint, exitPoint]
}
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ–≥–Ω—É—Ç–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏

```typescript
// –ò–∑–æ–≥–Ω—É—Ç–∞—è –¥–æ—Ä–æ–≥–∞ —Å –ø–æ–º–æ—â—å—é ExtrudeGeometry
<extrudeGeometry 
  args={[
    new THREE.Shape()
      .moveTo(points[0][0], points[0][2])
      .quadraticCurveTo(points[1][0], points[1][2], points[2][0], points[2][2]),
    {
      depth: roadWidth,
      bevelEnabled: false,
      steps: 1
    }
  ]}
/>
```

## –¢–∏–ø—ã –¥–æ—Ä–æ–∂–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤

### 1. –ü—Ä—è–º—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã
- **–£—Å–ª–æ–≤–∏–µ**: `Math.abs(entrySide - exitSide) === 3` (—Å—Ç–æ—Ä–æ–Ω—ã –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ)
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: –û–±—ã—á–Ω—ã–π PlaneGeometry
- **–ü—Ä–∏–º–µ—Ä**: –ó–µ–ª–µ–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ 0 ‚Üí –ö—Ä–∞—Å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ 3

### 2. –ò–∑–æ–≥–Ω—É—Ç—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã
- **–£—Å–ª–æ–≤–∏–µ**: `Math.abs(entrySide - exitSide) !== 3` (—Å—Ç–æ—Ä–æ–Ω—ã –Ω–µ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ)
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: ExtrudeGeometry —Å quadraticCurveTo
- **–ü—Ä–∏–º–µ—Ä**: –ó–µ–ª–µ–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ 0 ‚Üí –ö—Ä–∞—Å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ 1

## –ì–µ–æ–º–µ—Ç—Ä–∏—è –∏–∑–≥–∏–±–∞

### –¢–æ—á–∫–∏ –¥–æ—Ä–æ–≥–∏:
1. **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞** (–∑–µ–ª–µ–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞): –ù–∞ –∫—Ä–∞—é —è—á–µ–π–∫–∏ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∑–µ–ª–µ–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
2. **–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ç–æ—á–∫–∞** (–∏–∑–≥–∏–±): –ë–ª–∏–∂–µ –∫ —Ü–µ–Ω—Ç—Ä—É —è—á–µ–π–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è V-–æ–±—Ä–∞–∑–Ω–æ–π —Ñ–æ—Ä–º—ã
3. **–¢–æ—á–∫–∞ –≤—ã—Ö–æ–¥–∞** (–∫—Ä–∞—Å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞): –ù–∞ –∫—Ä–∞—é —è—á–µ–π–∫–∏ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∫—Ä–∞—Å–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã

### –§–æ—Ä–º—É–ª–∞ –∏–∑–≥–∏–±–∞:
```typescript
// –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –∫—Ä–∏–≤–∞—è –ë–µ–∑—å–µ
.moveTo(entryPoint[0], entryPoint[2])
.quadraticCurveTo(controlPoint[0], controlPoint[2], exitPoint[0], exitPoint[2])
```

## –í–∏–∑—É–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### –†–∞–∑–º–µ—Ä—ã:
- **–†–∞–¥–∏—É—Å —è—á–µ–π–∫–∏**: 0.8 –µ–¥–∏–Ω–∏—Ü (–¥–ª—è —Ç–æ—á–µ–∫ –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞)
- **–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ç–æ—á–∫–∞**: 30% –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ (–¥–ª—è –∏–∑–≥–∏–±–∞)
- **–®–∏—Ä–∏–Ω–∞ –¥–æ—Ä–æ–≥–∏**: 0.4 –µ–¥–∏–Ω–∏—Ü—ã (primary), 0.3 –µ–¥–∏–Ω–∏—Ü—ã (secondary)

### –ú–∞—Ç–µ—Ä–∏–∞–ª—ã:
- **–û—Å–Ω–æ–≤–Ω–∞—è –¥–æ—Ä–æ–≥–∞**: MeshStandardMaterial —Å roughness 0.6
- **–ë–µ–ª—ã–µ –ª–∏–Ω–∏–∏**: MeshStandardMaterial —Å roughness 0.3

### –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:
- **–í—ã—Å–æ—Ç–∞**: 0.05 –µ–¥–∏–Ω–∏—Ü (—á—É—Ç—å –≤—ã—à–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏)
- **–ü–æ–≤–æ—Ä–æ—Ç**: –ù–∞ –æ—Å–Ω–æ–≤–µ —É–≥–ª–∞ –º–µ–∂–¥—É –∑–µ–ª–µ–Ω–æ–π –∏ –∫—Ä–∞—Å–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–∞–º–∏

## –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–î–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
```typescript
console.log(`üîó –Ø—á–µ–π–∫–∞ (${q},${r}): –ó–µ–ª–µ–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ ${entrySide} ‚Üí –ö—Ä–∞—Å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ ${exitSide}`)
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π

| –ê—Å–ø–µ–∫—Ç | –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ |
|--------|-------------------|---------------------|
| –ì–µ–æ–º–µ—Ç—Ä–∏—è | –ü—Ä—è–º—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã | –ò–∑–æ–≥–Ω—É—Ç—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã |
| –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ | –†–∞–∑—Ä—ã–≤–Ω–æ–µ | –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ |
| –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | –ü–ª–æ—Å–∫–∏–µ –ª–∏–Ω–∏–∏ | V-–æ–±—Ä–∞–∑–Ω—ã–µ –∏–∑–≥–∏–±—ã |
| –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º–µ | –ù–µ—Ç | –î–∞ |

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

1. **‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º–µ**: –î–æ—Ä–æ–≥–∏ –∏–∑–≥–∏–±–∞—é—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ –±–ª–æ–∫—É "result"
2. **‚úÖ –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: V-–æ–±—Ä–∞–∑–Ω—ã–µ –∏–∑–≥–∏–±—ã –≤—ã–≥–ª—è–¥—è—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ
3. **‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ**: –ö—Ä–∞—Å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ = –ó–µ–ª–µ–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ —Å–æ—Å–µ–¥–∞
4. **‚úÖ –ì–∏–±–∫–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–∫ –ø—Ä—è–º—ã—Ö, —Ç–∞–∫ –∏ –∏–∑–æ–≥–Ω—É—Ç—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: http://localhost:5173
2. **–°–æ–∑–¥–∞–π—Ç–µ –æ–±—ä–µ–∫—Ç—ã** –∏ –Ω–∞–∂–º–∏—Ç–µ "üõ£Ô∏è Test Roads"
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å** –¥–ª—è –ª–æ–≥–æ–≤ –∑–µ–ª–µ–Ω—ã—Ö –∏ –∫—Ä–∞—Å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω
4. **–ù–∞–±–ª—é–¥–∞–π—Ç–µ** –∑–∞ V-–æ–±—Ä–∞–∑–Ω—ã–º–∏ –∏–∑–≥–∏–±–∞–º–∏ –¥–æ—Ä–æ–≥

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –î–æ—Ä–æ–≥–∏ –∏–∑–≥–∏–±–∞—é—Ç—Å—è –æ—Ç –∑–µ–ª–µ–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∫ –∫—Ä–∞—Å–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–µ
- ‚úÖ V-–æ–±—Ä–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞ —Å –∏–∑–≥–∏–±–æ–º –∫ —Ü–µ–Ω—Ç—Ä—É —è—á–µ–π–∫–∏
- ‚úÖ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º–µ "result"

## –°—Ç–∞—Ç—É—Å

‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–æ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∏–∑–æ–≥–Ω—É—Ç—ã—Ö –¥–æ—Ä–æ–≥
‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ**: –í –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚úÖ **–û—Ç–ª–∞–¥–∫–∞**: –î–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
üîÑ **–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–≥–Ω—É—Ç—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏:
- ‚úÖ –ò–∑–æ–≥–Ω—É—Ç—ã–µ –¥–æ—Ä–æ–≥–∏ –æ—Ç –∑–µ–ª–µ–Ω–æ–π –∫ –∫—Ä–∞—Å–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–µ
- ‚úÖ V-–æ–±—Ä–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞ —Å –∏–∑–≥–∏–±–æ–º –∫ —Ü–µ–Ω—Ç—Ä—É
- ‚úÖ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º–µ "result"
